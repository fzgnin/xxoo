<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
	<meta name="renderer" content="webkit">
    <title>{$meta_title}|OneThink管理平台</title>
    <link href="__ROOT__/Public/favicon.ico" type="image/x-icon" rel="shortcut icon">
     <script type="text/javascript" src="__STATIC__/jquery-2.0.3.min.js"></script>
     <script type="text/javascript" src="__LAYER__/layer.js"></script>
    
</head>
<body>
<link rel="stylesheet" href="__CSS__/font-awesome.min.css" type="text/css" />                       
<style type="text/css">
.bill-container {
    border: 1px solid #CFCFCF;
    box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
    padding: 10px 20px 20px;
    margin-bottom: 20px;
}

*, h1, h2, h3, h4, h5, h6 {
    font-family: "Lucida Console","Monaco","Courier New","mono","monospace","Segoe UI","Lucida Grande",Helvetica,Arial,"Microsoft YaHei",FreeSans,Arimo,"Droid Sans","wenquanyi micro hei","Hiragino Sans GB","Hiragino Sans GB W3",sans-serif;
}
*, *::before, *::after {
    box-sizing: border-box;
}

html, body {
    color: #656565;
}body {
    font-family: Arial,Helvetica,sans-serif;
    font-size: 13px;
    line-height: 1.4;
    color: #333;
}
.bill-container .bill-header .bill-subject {
    height: 70px;
    margin: 0px 0px 20px;
    position: relative;
    color: #000;
    border-bottom: 1px solid #EFEFEF;
}.bill-container .bill-header .bill-subject .bill-subject-left {
    position: absolute;
    left: 0px;
    top: 0px;
    font-size: 12px;
}bill-container .bill-header .bill-subject {
    color: #000;
}.bill-container .bill-header .bill-subject .bill-subject-left .subject {
    border-right: 1px solid #666;
    padding: 5px 10px 5px 0px;
    margin-right: 10px;
}.pull-left {
    float: left !important;
}.bill-container .bill-header .bill-subject .bill-subject-left {
    font-size: 12px;
}.bill-container .bill-header .bill-subject .bill-subject-left h1 {
    font-size: 24px;
    margin: 0px;
    padding: 10px 0px;
}h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    font-weight: 500;
    line-height: 1.1;
    color: inherit;
}.bill-container .bill-header .bill-subject .bill-subject-left .subject input {
    border: 0px none;
    text-align: center;
}a, button, input {
    transition: all 0.1s ease-out 0s;
}input, button, select, textarea {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
}.bill-container .bill-header .bill-subject .bill-subject-left .company-info {
    padding-top: 8px;
}.pull-left {
    float: left !important;
}.bill-container .bill-header .bill-subject .bill-subject-left .company-info small {
    display: block;
    margin: 1px 0px;
}small, .small {
    font-size: 85%;
}[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak, .ng-hide:not(.ng-hide-animate) {
    display: none !important;
}.bill-container .bill-header .bill-subject .bill-subject-left .company-info small {
    display: block;
    margin: 1px 0px;
}.bill-container .bill-header .bill-bar-code {
    font-size: 11px;
    color: #222;
    line-height: 180%;
    text-align: right;
    width: 400px;
    position: absolute;
    right: 0px;
    top: 10px;
}.bill-container .bill-header .bill-bar-code img {
    max-width: 100%;
}
img {
    vertical-align: middle;
}
img {
    border: 0px none;
}.bill-container .bill-header .bill-bar-code {
    font-size: 11px;
    color: #222;
    line-height: 180%;
    text-align: right;
}html, body {
    color: #656565;
}.table-bordered {
    border: 1px solid #DDD;
}.table {
    margin-bottom: 18px;
}.table {
    width: 100%;
    margin-bottom: 20px;
}table {
    background-color: transparent;
}table {
    max-width: 100%;
    background-color: transparent;
}table {
    border-collapse: collapse;
    border-spacing: 0px;
}table {
    border-collapse: collapse;
    border-spacing: 0px;
}.table > caption + thead > tr:first-child > th, .table > colgroup + thead > tr:first-child > th, .table > thead:first-child > tr:first-child > th, .table > caption + thead > tr:first-child > td, .table > colgroup + thead > tr:first-child > td, .table > thead:first-child > tr:first-child > td {
    border-top: 0px none;
}.table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {
    border: 1px solid #DDD;
}.table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
    line-height: 1.4;
    border-top: 1px solid #DDD;
}.table > thead > tr > th {
    vertical-align: bottom;
    border-bottom: 2px solid #DDD;
}.table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
    padding: 8px;
    line-height: 1.42857;
    vertical-align: top;
    border-top: 1px solid #DDD;
}.bill-rows table th {
    background: #F2F2F2 none repeat scroll 0% 0%;
}th {
    text-align: left;
}.bill-rows table th label {
    margin-bottom: 0px;
}label {
    display: inline-block;
    margin-bottom: 5px;
    font-weight: bold;
}[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak, .ng-hide:not(.ng-hide-animate) {
    display: none !important;
}.pull-right {
    float: right !important;
}.dropdown {
    position: relative;
}a, a:hover, a:active {
    text-decoration: none;
    cursor: pointer;
}a, button, input {
    transition: all 0.1s ease-out 0s;
}a {
    color: #15C;
}a {
    background: transparent none repeat scroll 0% 0%;
}.fa {
    display: inline-block;
    font-family: FontAwesome;
    font-style: normal;
    font-weight: normal;
    line-height: 1;
    font-size-adjust: none;
    font-stretch: normal;
    font-feature-settings: normal;
    font-language-override: normal;
    font-kerning: auto;
    font-synthesis: weight style;
    font-variant: normal;
    font-size: inherit;
    text-rendering: auto;
    transform: translate(0px, 0px);
}.pull-right > .dropdown-menu {
    right: 0px;
    left: auto;
}.dropdown-menu {
    padding: 6px 0px;
    margin: 1px 0px 0px;
    font-size: 13px;
    background-color: #FFF;
    border: 1px solid rgba(0, 0, 0, 0.2);
    border-radius: 0px;
    box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
}.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0px;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0px;
    margin: 2px 0px 0px;
    font-size: 14px;
    list-style: outside none none;
    background-color: #FFF;
    border: 1px solid rgba(0, 0, 0, 0.15);
    border-radius: 4px;
    box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.176);
    background-clip: padding-box;
}.table-bordered > thead > tr > th, .table-bordered > tbody > tr > th, .table-bordered > tfoot > tr > th, .table-bordered > thead > tr > td, .table-bordered > tbody > tr > td, .table-bordered > tfoot > tr > td {
    border: 1px solid #DDD;
}.table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
    line-height: 1.4;
    border-top: 1px solid #DDD;
}.table > thead > tr > th, .table > tbody > tr > th, .table > tfoot > tr > th, .table > thead > tr > td, .table > tbody > tr > td, .table > tfoot > tr > td {
    padding: 8px;
    line-height: 1.42857;
    vertical-align: top;
    border-top: 1px solid #DDD;
}.text-center {
    text-align: center;
}.bill-rows table .operations-td i {
    margin: 0px 3px;
    cursor: pointer;
}.fa-plus::before {
    content: "";
}.bill-rows table .operations-td i {
    cursor: pointer;
}.fa-trash-o::before {
    content: "";
}.bill-rows table td[bill-edit-able] {
    padding: 0px;
    position: relative;
}.bill-footer-input {
    margin-left: 0px;
}.bill-footer-input .bill-footer-input-item {
    margin: 8px 15px 10px 0px;
    float: left;
    width: 300px;
}.input-group {
    position: relative;
    display: table;
    border-collapse: separate;
}.bill-footer-input .bill-footer-input-item .input-group-addon {
    height: 30px;
}.input-group-addon:first-child {
    border-right: 0px none;
}.input-group .form-control:last-child, .input-group-addon:last-child, .input-group-btn:last-child > .btn, .input-group-btn:last-child > .dropdown-toggle, .input-group-btn:first-child > .btn:not(:first-child) {
    border-bottom-left-radius: 0px;
    border-top-left-radius: 0px;
}.bill-footer-input .bill-footer-input-item {
    margin: 8px 15px 10px 0px;
    float: left;
    width: 300px;
}.input-group {
    position: relative;
    display: table;
    border-collapse: separate;
}.bill-footer-input .bill-footer-input-item .input-group-addon {
    height: 30px;
}.input-group-addon:first-child {
    border-right: 0px none;
}.dl-horizontal dd::before, .dl-horizontal dd::after, .container::before, .container::after, .container-fluid::before, .container-fluid::after, .row::before, .row::after, .form-horizontal .form-group::before, .form-horizontal .form-group::after, .btn-toolbar::before, .btn-toolbar::after, .btn-group-vertical > .btn-group::before, .btn-group-vertical > .btn-group::after, .nav::before, .nav::after, .navbar::before, .navbar::after, .navbar-header::before, .navbar-header::after, .navbar-collapse::before, .navbar-collapse::after, .pager::before, .pager::after, .panel-body::before, .panel-body::after, .modal-footer::before, .modal-footer::after {
    content: " ";
    display: table;
}.input-group .form-control:first-child, .input-group-addon:first-child, .input-group-btn:first-child > .btn, .input-group-btn:first-child > .dropdown-toggle, .input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle) {
    border-top-right-radius: 0px;
    border-bottom-right-radius: 0px;
}.input-group-addon {
    padding: 5px 8px;
    font-size: 13px;
    color: #555;
    border-width: 1px;
    border-style: solid;
    border-color: #C0C0C0 #D9D9D9 #D9D9D9;
    -moz-border-top-colors: none;
    -moz-border-right-colors: none;
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    border-image: none;
    border-radius: 2px;
}.input-group-addon, .input-group-btn, .input-group .form-control {
    margin: 0px;
    border-radius: 0px;
}.input-group-addon {
    padding: 6px 12px;
    font-size: 14px;
    font-weight: normal;
    line-height: 1;
    color: #555;
    text-align: center;
    background-color: #EEE;
    border: 1px solid #CCC;
    border-radius: 4px;
}.input-group-addon, .input-group-btn {
    width: 1%;
    white-space: nowrap;
    vertical-align: middle;
}.input-group-addon, .input-group-btn, .input-group .form-control {
    display: table-cell;
}.input-group {
    border-collapse: separate;
}.input-group .form-control:last-child, .input-group-addon:last-child, .input-group-btn:last-child > .btn, .input-group-btn:last-child > .dropdown-toggle, .input-group-btn:first-child > .btn:not(:first-child) {
    border-bottom-left-radius: 0px;
    border-top-left-radius: 0px;
}.input-group-addon, .input-group-btn, .input-group .form-control {
    margin: 0px;
    border-radius: 0px;
}.input-group-addon, .input-group-btn, .input-group .form-control {
    display: table-cell;
}
.input-group .form-control {
    width: 100%;
    margin-bottom: 0px;
}
.form-control {
    height: 30px;
    padding: 5px 8px;
    font-size: 13px;
    line-height: 1.4;
    background-color: #FFF;
    border-width: 1px;
    border-style: solid;
    border-color: #C0C0C0 #D9D9D9 #D9D9D9;
    -moz-border-top-colors: none;
    -moz-border-right-colors: none;
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    border-image: none;
    border-radius: 1px;
    box-shadow: none;
    transition: none 0s ease 0s;
}
.form-control {
    display: block;
    width: 100%;
    height: 34px;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.42857;
    color: #555;
    vertical-align: middle;
    background-color: #FFF;
    background-image: none;
    border: 1px solid #CCC;
    border-radius: 4px;
    box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.075) inset;
    transition: border-color 0.15s ease-in-out 0s, box-shadow 0.15s ease-in-out 0s;
}input, button, select, textarea {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
}.input-group .form-control:first-child, .input-group-addon:first-child, .input-group-btn:first-child > .btn, .input-group-btn:first-child > .dropdown-toggle, .input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle) {
    border-top-right-radius: 0px;
    border-bottom-right-radius: 0px;
}.bill-footer-input .bill-footer-input-item .input-group-addon {
    height: 30px;
}
.input-group-addon:first-child {
    border-right: 0px none;
}.bill-footer .bill-footer-meta {
    margin-bottom: 20px;
}.bill-footer .bill-footer-meta .label {
    margin-right: 5px;
    padding: 5px 5px 4px;
    font-weight: normal;
}
.label-primary {
    background-color: #4D90FE;
}
.label {
    font-size: 80%;
    border-radius: 0px;
}.label {
    display: inline;
    padding: 0.2em 0.6em 0.3em;
    font-size: 75%;
    font-weight: bold;
    line-height: 1;
    color: #FFF;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25em;
}.bill-footer .bill-footer-meta .label {
    font-weight: normal;
}
.label {
    font-size: 80%;
}
.label {
    font-size: 75%;
    font-weight: bold;
    line-height: 1;
    color: #FFF;
    text-align: center;
    white-space: nowrap;
}.pull-right {
    float: right !important;
}.btn {
    font-weight: normal;
}
.btn-lg {
    padding: 9px 14px;
    font-size: 14px;
    line-height: 1.3;
    border-radius: 2px;
}
.btn-primary {
    color: #FFF;
    text-shadow: 0px 1px rgba(0, 0, 0, 0.1);
    background-image: linear-gradient(to bottom, #4D90FE 0%, #4787ED 100%);
    background-repeat: repeat-x;
    border: 1px solid #3079ED;
}
.btn {
    padding: 5px 12px;
    font-size: 13px;
    font-weight: bold;
    line-height: 18px;
    cursor: default;
    border-radius: 2px;
    box-shadow: none;
    background-clip: border-box;
}
.btn-lg {
    padding: 10px 16px;
    font-size: 18px;
    line-height: 1.33;
    border-radius: 6px;
}
.btn-primary {
    color: #FFF;
    background-color: #428BCA;
    border-color: #357EBD;
}
.btn {
    display: inline-block;
    padding: 6px 12px;
    margin-bottom: 0px;
    font-size: 14px;
    font-weight: normal;
    line-height: 1.42857;
    text-align: center;
    white-space: nowrap;
    vertical-align: middle;
    cursor: pointer;
    background-image: none;
    border: 1px solid transparent;
    border-radius: 4px;
    -moz-user-select: none;
}
a, button, input {
    transition: all 0.1s ease-out 0s;
}
input, button, select, textarea {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
}

.td_huang{padding:0px !important;width:200px !important}
.form-huang{
 border:none!important;border-radius:0px!important;width:100% !important
}
 ul li{  
list-style-type:none;
margin:0px;
padding:0px;  
}  
</style>
<div class="bill-container ng-scope" style="width:1200px;float:left">
    <div class="ng-scope" ><div class="bill-header ng-scope">
    <div class="bill-subject">
        <div class="bill-subject-left">
            <div class="subject pull-left">
                <h1>
                    <input value="<eq name="order_info.order_type" value="1">销售出库单<else/>销售退货单</eq>" type="text">
                </h1>
            </div>
            <div class="company-info pull-left">
                <small class="ng-binding" ng-bind="system_preference.company_name" ng-show="system_preference.company_name"><eq name="order_info.order_type" value="1">上海国际雅兰出库单<else/>上海国际雅兰退货单</eq></small>
            </div>
        </div>
        <div class="bill-bar-code" id="bar-code"></div>
    </div>
</div>

<div class="bill-footer-input row">
            <div class="bill-footer-input-item">
                <div class="input-group ng-scope">
				<span class="input-group-addon">录单日期</span>
				<span class="form-control input_widget_number ng-pristine ng-untouched ng-valid">{$order_info.add_time|date='Y-m-d',###}</span>
				</div>
            </div>
			
			<div class="bill-footer-input-item">
                <div class="input-group ng-scope">
				<span class="input-group-addon"><eq name="order_info.order_type" value="1">出货单编号<else/>退货单编号</eq></span>
				<span class="form-control input_widget_number ng-pristine ng-untouched ng-valid">{$order_info.order_sn}</span>
				</div>
            </div>
			
		
            <div class="bill-footer-input-item">
                <div class="input-group ng-scope">
				<span class="input-group-addon"><eq name="order_info.order_type" value="1">收货单位<else/>退货单位</eq></span>
				<span class="form-control input_widget_number ng-pristine ng-untouched ng-valid">{$order_info.gname}</span>
				</div>
            </div>
            <div class="bill-footer-input-item">
                <div class="input-group ng-scope">
				<span class="input-group-addon"><eq name="order_info.order_type" value="1">出库仓库<else/>入库仓库</eq></span>
				<span class="form-control input_widget_number ng-pristine ng-untouched ng-valid">{$order_info.warehouse}</span>
				</div>
            </div>
			
			<div class="bill-footer-input-item">
                <div class="input-group ng-scope">
				<span class="input-group-addon">经手人</span>
				<span class="form-control input_widget_number ng-pristine ng-untouched ng-valid">{$order_info.bname}</span>
				</div>
            </div>
			
			<div class="input-group bill-footer-input-item" style="width: auto">
                <span class="input-group-addon ng-binding" ng-bind="'common.Remark'|lang">备注</span>
                <span class="form-control input_widget_number ng-pristine ng-untouched ng-valid">{$order_info.remarks}</span>
            </div>
        </div>
</div>
    <div class="bill-body">
        <div config="bill_config" class="bill-rows ng-isolate-scope">
    <table class="table table-bordered bill-rows-table">
        <thead>
            <tr>
                <th class="text-center" width="50">#</th>
                <th class="ng-scope" >
                    <label class="ng-binding">商品编号</label>      
                </th><th class="ng-scope" >
                    <label class="ng-binding">商品全名</label>         
                </th><th class="ng-scope" >
                    <label class="ng-binding">规格</label>     
                </th><th class="ng-scope" >
                    <label class="ng-binding">数量</label>    
                </th><th class="ng-scope" >
                    <label class="ng-binding">单价</label>      
                </th><th class="ng-scope" >
                    <label class="ng-binding">金额</label>      
                </th><th style="" class="ng-scope" >
                    <label class="ng-binding">开单折扣</label>       
                </th><th class="ng-scope" >
                    <label class="ng-binding">折后单价</label>          
                </th><th class="ng-scope"  style="border-right: 1px solid rgb(248, 65, 65);">
                    <label class="ng-binding">折后金额</label>                  
                </th>	
				<th style="border: 1px solid #F84141;" class="ng-scope" >
                    <label class="ng-binding">过账折扣</label>          
                </th><th class="ng-scope"  style="border: 1px solid #F84141;">
                    <label class="ng-binding">过账折后单价</label>       
                </th><th class="ng-scope"  style="border: 1px solid #F84141;">
                    <label class="ng-binding">过账折后金额</label>      
                </th>		
            </tr>
        </thead>
        <tbody>
		<volist name="goods_list" id="vo">
            <tr>
                <td class="text-center">#<span class="paixu">{$key+1}</span></td>
                <td >{$vo.code}</td>
				<td>{$vo.goodsname}</td>
				<td>{$vo.format}</td>
				<td>{$vo.num}</td>
				<td>{$vo.price}</td>
				<td>{$vo.totalprice}</td>
				<td>{$vo.k_zhekou}</td>
				<td>{$vo.k_price}</td>
				<td>{$vo.k_totalprice}</td>
				<td>{$vo.g_zhekou}</td>
				<td>{$vo.g_price}</td>
				<td>{$vo.g_totalprice}</td>
            </tr>
			</volist>
        </tbody>
        <tfoot>
            <tr>
               <td colspan="2" align="center"><strong class="ng-binding">合计</strong></td>
               
			   <td class="ng-scope"></td>
			   <td class="ng-scope"></td>
			   <td class="ng-scope">
			   
			   </td>
			   <td class="ng-scope"></td>
			   <td class="ng-scope">
			   {$order_info.amount}
			   </td>
			   <td class="ng-scope" ></td>
			   <td class="ng-scope" ></td>
			   <td class="ng-scope" >
			   {$order_info.k_amount}
			   </td>
			   <td class="ng-scope" ></td>
			   <td class="ng-scope" ></td>
			   <td class="ng-scope" id="td_amount" >
			   {$order_info.g_amount}
			   </td>
            </tr>
        </tfoot>
    </table>
</div>
    </div>

</div>

<div class="bill-container ng-scope" style="width:266px;float:right; padding:3px 10px 10px">
<h1>分单操作</h1>
<form id="form_fendan" name="form_fendan">
<table class="table table-bordered bill-rows-table">
        <thead>
            <tr>
                <th style="text-align:center" width="60"><i class="fa fa-plus" style="cursor: pointer;"></i></th>
                
                <th class="ng-scope">
                    <label class="ng-binding">部门名称</label>      
                </th><th class="ng-scope">
                    <label class="ng-binding">销售业绩</label>         
                </th>
					
            </tr>
        </thead>
		
        <tbody id="tbody_id">
            <volist name="feat_list" id="vo">
			<tr>
                <td class="text-center">
                    <i class="fa fa-trash-o" style="cursor: pointer;"></i>
                </td>
               
                <td class="td_huang">
					<input  class="form-control form-huang" onKeyDown="enter_up(this,'doublebumen')" value="{$vo.bname}" title="{$vo.bname}" onBlur="check_info(this)" type="text">
					<input name="bid[]" value="{$vo.bid}" type="hidden">
                </td>
				<td class="td_huang" style="width: 200px !important;"><input class="form-control form-huang" name="money[]" value="{$vo.feat}" onBlur="calculate_money()" type="text"></td>
				
				
				<input type="hidden" name="feat_id[]" value="{$vo.id}">
            </tr>
			</volist>
        </tbody>
		
        <tfoot>
            <tr>
               <td colspan="2" align="center"><strong class="ng-binding">合计</strong></td>
               <td class="ng-scope" id="g_amount_id">{$order_info.g_amount}</td>
			   
			  
			   
			   
            </tr>
        </tfoot>
    </table>
	<input type="hidden" name="id" value="{$order_info.id}">
	<input type="hidden" name="order_type" value="{$order_info.order_type}">
	</form>
	<div style="text-align:center"><a style="display: inline-block;
margin-right: 5px;
padding: 8px 10px;
font-size: 14px;
line-height: 18px;
color: #edffd1;
text-align: center;
vertical-align: middle;
cursor: pointer;
border: 0 none;
background-color: #9100BD;
*outline: 0 none;
border-radius: 3px;" onClick="checkandform();">确认分单</a></div>
</div>
<script type="text/javascript">
var URL_JS = "__URL__";
var APP = "__APP__";

function enter_up(obj,ocj)
	{
		var theEvent = window.event || arguments.callee.caller.arguments[0];    
        var code = theEvent.keyCode || theEvent.which || theEvent.charCode;    
        if (code == 13) {    
            var url = APP+"/Admin/Ajaxquery/select_information/keywords/"+obj.value+"/type/"+ocj;
			layer.open({
				type: 2,
				title: '选择相关信息',
				shadeClose: false,
				shade: 0.8,
				shift:5,
				area: ['900px', '530px'],
				content: url //iframe的url
			});
			$(obj).blur();
            return false;    
        }    
        return true;	
	}
	
	
	function call_back()
	{
	  
	calculate_money();
	}
	
	
	
	//删除一行
$('.fa-trash-o').bind('click', function() {
 $(this).parent().parent().remove();

 //重拍序列号
 $('.paixu').each(function(i){
   $(this).html(i+1);
 });
 calculate_money();
});

//增加一行
$('.fa-plus').bind('click',function(){
 var res = '<tr><td class="text-center"><i class="fa fa-trash-o" style="cursor: pointer;"></i></td><td class="td_huang"><input class="form-control form-huang" onKeyDown="enter_up(this,&quot;doublebumen&quot;)" value=""  onBlur="check_info(this)" type="text"><input name="bid[]" value="" type="hidden"></td><td class="td_huang" style="width: 200px !important;"><input class="form-control form-huang" name="money[]" value="" onBlur="calculate_money()" type="text"></td></tr>';
 $('#tbody_id').append(res);
 
 //重拍序列号
 $('.paixu').each(function(i){
   $(this).html(i+1);
 });
 
 //动态绑定事件
 $(".fa-trash-o").on("click", function() {
		$(this).parent().parent().remove();
	
	 //重拍序列号
	 $('.paixu').each(function(i){
	   $(this).html(i+1);
	 });
	calculate_money(); 
 });
});

//动态添加商品函数
 function add_goods(str)
 {
   //记录总行数
   var tr_length = $('#tbody_id tr').length;

   //删除没有商品编号或者商品全名的行
   for(i=tr_length-1;i>=0;i--)
   {
	 if(!$('#tbody_id tr').eq(i).find('input').eq(0).val() || !$('#tbody_id tr').eq(i).find('input').eq(1).val())
	 {
	   //删除此行
	   $('#tbody_id tr').eq(i).remove();
	 }
   }  
   //插入新增行
   $('#tbody_id').append(str);
   
   //绑定事件
	$('.fa-trash-o').on('click', function() {
	$(this).parent().parent().remove();
	calculate_money();
	});
	
	
		
   //计算现有行数
 }
 
 function check_info(obj)
 {
	obj.value = obj.title;
 }
 
 function calculate_money()
 {
    //alert($('#tbody_id').find('tr').length);
	
	var all_amount = 0;
	
	for(i=0;i<$('#tbody_id').find('tr').length;i++)
	{
	   all_amount = accAdd($('#tbody_id').find('tr').eq(i).find('input').eq(2).val(),all_amount);
	}
	
	$('#g_amount_id').html(all_amount);
 
 }
 
 
 //乘
function accMul(arg1,arg2)   
{   
    var m=0,s1=arg1.toString(),s2=arg2.toString();   
    try{m+=s1.split(".")[1].length}catch(e){}   
    try{m+=s2.split(".")[1].length}catch(e){}   
    return Number(s1.replace(".",""))*Number(s2.replace(".",""))/Math.pow(10,m)   
}   
 //除 
function accDiv(arg1,arg2){   
    var t1=0,t2=0,r1,r2;   
    try{t1=arg1.toString().split(".")[1].length}catch(e){}   
    try{t2=arg2.toString().split(".")[1].length}catch(e){}   
    with(Math){   
    r1=Number(arg1.toString().replace(".",""))   
    r2=Number(arg2.toString().replace(".",""))   
    return (r1/r2)*pow(10,t2-t1);   
    }   
}   
//加
function accAdd(arg1,arg2){      
   var r1,r2,m;      
   try{r1=arg1.toString().split(".")[1].length}catch(e){r1=0}    
   try{r2=arg2.toString().split(".")[1].length}catch(e){r2=0}     
        m=Math.pow(10,Math.max(r1,r2))  
        return (accMul(arg1,m)+accMul(arg2,m))/m      
}
//减       
function accSub(arg1,arg2){      
   var r1,r2,m;      
   try{r1=arg1.toString().split(".")[1].length}catch(e){r1=0}    
   try{r2=arg2.toString().split(".")[1].length}catch(e){r2=0}     
        m=Math.pow(10,Math.max(r1,r2))  
        return (accMul(arg1,m)-accMul(arg2,m))/m      
}   

function checkandform()
{

//判断分担后的总金额是否与订单金额相符合
var td_amount = parseFloat($('#td_amount').html());
var g_amount_id = parseFloat($('#g_amount_id').html());

if( 0 != accSub(g_amount_id,td_amount))
{
  layer.msg('过账金额与分单后总金额不符！',{icon:2,time: 3000});
  return false;
}


var url = '__URL__/splitinsert';
	  
	  layer.confirm('确定要分单吗？',function(index)
				  {
					$.ajax({
					type:'POST',
					data:$('#form_fendan').serialize(),
					url:url,
					success:function(data)
						{
						  if(data.status)
						  {
							  
							  parent.layer.msg(data.info,{icon:1,time: 1000});
							  
							  parent.table_order_page(0);
							  parent.layer.closeAll('iframe');
							  
						  }else
						  {
							  //parent.layer.closeAll();
							  layer.msg(data.info,{icon:2,time: 3000});
						  }
						}					
					});	  
				  })

}


</script>

   
</body>
</html>